<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ÌîΩÏÖÄÏïÑÌä∏ Ïä§ÌäúÎîîÏò§</title>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap');
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Inter', sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }
        
        .container {
            max-width: 1400px;
            margin: 0 auto;
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(20px);
            border-radius: 24px;
            padding: 30px;
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.2);
        }
        
        .header {
            text-align: center;
            margin-bottom: 40px;
        }
        
        .header h1 {
            font-size: 2.5rem;
            font-weight: 700;
            background: linear-gradient(135deg, #667eea, #764ba2);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            margin-bottom: 10px;
        }
        
        .header p {
            color: #6b7280;
            font-size: 1.1rem;
            font-weight: 400;
        }
        
        .main-content {
            display: grid;
            grid-template-columns: 1fr 2fr 1fr;
            gap: 30px;
            margin-bottom: 30px;
        }
        
        .left-panel, .right-panel {
            background: rgba(248, 250, 252, 0.8);
            border-radius: 16px;
            padding: 24px;
            border: 1px solid rgba(226, 232, 240, 0.5);
        }
        
        .canvas-section {
            display: flex;
            flex-direction: column;
            align-items: center;
            background: white;
            border-radius: 20px;
            padding: 30px;
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.1);
            border: 1px solid rgba(226, 232, 240, 0.3);
        }
        
        .section-title {
            font-size: 1.3rem;
            font-weight: 600;
            color: #1f2937;
            margin-bottom: 20px;
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        .tool-group {
            margin-bottom: 24px;
        }
        
        .tool-group label {
            display: block;
            font-weight: 500;
            color: #374151;
            margin-bottom: 8px;
            font-size: 0.95rem;
        }
        
        .canvas-controls {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 12px;
            margin-bottom: 20px;
        }
        
        .custom-canvas {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 8px;
            margin-top: 10px;
        }
        
        select, input[type="number"] {
            width: 100%;
            padding: 12px;
            border: 2px solid #e5e7eb;
            border-radius: 12px;
            font-size: 14px;
            font-weight: 500;
            background: white;
            transition: all 0.2s ease;
        }
        
        select:focus, input:focus {
            outline: none;
            border-color: #667eea;
            box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
        }
        
        .color-picker {
            width: 100%;
            height: 50px;
            border: 3px solid #e5e7eb;
            border-radius: 12px;
            cursor: pointer;
            transition: all 0.2s ease;
        }
        
        .color-picker:hover {
            border-color: #667eea;
            transform: scale(1.02);
        }
        
        .drawing-tools {
            display: grid;
            grid-template-columns: 1fr 1fr 1fr;
            gap: 8px;
        }
        
        .tool-btn {
            padding: 12px 8px;
            border: 2px solid #e5e7eb;
            border-radius: 12px;
            background: white;
            color: #6b7280;
            font-weight: 500;
            font-size: 14px;
            cursor: pointer;
            transition: all 0.2s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 6px;
        }
        
        .tool-btn:hover {
            border-color: #667eea;
            color: #667eea;
            transform: translateY(-2px);
        }
        
        .tool-btn.active {
            background: #667eea;
            color: white;
            border-color: #667eea;
        }
        
        .preset-colors {
            display: grid;
            grid-template-columns: repeat(6, 1fr);
            gap: 8px;
        }
        
        .preset-color {
            width: 100%;
            height: 40px;
            border: 3px solid #e5e7eb;
            border-radius: 10px;
            cursor: pointer;
            transition: all 0.2s ease;
            position: relative;
        }
        
        .preset-color:hover {
            border-color: #374151;
            transform: scale(1.1);
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
        }
        
        .preset-color.selected {
            border-color: #667eea;
            border-width: 4px;
        }
        
        #pixelCanvas {
            border: 3px solid #e5e7eb;
            border-radius: 16px;
            cursor: crosshair;
            background-color: white;
            image-rendering: pixelated;
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.1);
            transition: all 0.2s ease;
            margin-bottom: 20px;
        }
        
        #pixelCanvas:hover {
            box-shadow: 0 12px 35px rgba(0, 0, 0, 0.15);
        }
        
        .canvas-info {
            display: flex;
            gap: 20px;
            margin-bottom: 20px;
            font-size: 14px;
            color: #6b7280;
        }
        
        .canvas-info span {
            background: rgba(102, 126, 234, 0.1);
            padding: 6px 12px;
            border-radius: 8px;
            font-weight: 500;
        }
        
        .action-buttons {
            display: flex;
            gap: 12px;
            flex-wrap: wrap;
            justify-content: center;
        }
        
        .btn {
            padding: 12px 24px;
            border: none;
            border-radius: 12px;
            font-weight: 600;
            font-size: 14px;
            cursor: pointer;
            transition: all 0.2s ease;
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        .btn-primary {
            background: linear-gradient(135deg, #667eea, #764ba2);
            color: white;
        }
        
        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(102, 126, 234, 0.3);
        }
        
        .btn-secondary {
            background: white;
            color: #6b7280;
            border: 2px solid #e5e7eb;
        }
        
        .btn-secondary:hover {
            border-color: #667eea;
            color: #667eea;
            transform: translateY(-2px);
        }
        
        .btn-danger {
            background: #ef4444;
            color: white;
        }
        
        .btn-danger:hover {
            background: #dc2626;
            transform: translateY(-2px);
        }
        
        .helper-tools {
            margin-top: 20px;
        }
        
        .helper-btn {
            width: 100%;
            padding: 16px;
            margin-bottom: 12px;
            border: 2px dashed #d1d5db;
            border-radius: 12px;
            background: rgba(249, 250, 251, 0.5);
            color: #6b7280;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.2s ease;
            text-align: center;
        }
        
        .helper-btn:hover {
            border-color: #667eea;
            color: #667eea;
            background: rgba(102, 126, 234, 0.05);
        }
        
        .templates {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 10px;
            margin-top: 15px;
        }
        
        .template-btn {
            aspect-ratio: 1;
            border: 2px solid #e5e7eb;
            border-radius: 10px;
            background: white;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 24px;
            transition: all 0.2s ease;
        }
        
        .template-btn:hover {
            border-color: #667eea;
            transform: scale(1.05);
        }
        
        .modal {
            position: fixed;
            z-index: 1000;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0,0,0,0.5);
            backdrop-filter: blur(5px);
        }
        
        .modal-content {
            background: white;
            margin: 10% auto;
            padding: 30px;
            border-radius: 20px;
            width: 90%;
            max-width: 500px;
            position: relative;
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.2);
        }
        
        .close {
            color: #aaa;
            float: right;
            font-size: 28px;
            font-weight: bold;
            cursor: pointer;
            position: absolute;
            right: 20px;
            top: 15px;
        }
        
        .close:hover {
            color: #000;
        }
        
        .form-group {
            margin-bottom: 20px;
        }
        
        .form-group label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            color: #374151;
        }
        
        .form-group input,
        .form-group textarea {
            width: 100%;
            padding: 12px;
            border: 2px solid #e5e7eb;
            border-radius: 10px;
            font-size: 14px;
            box-sizing: border-box;
            font-family: 'Inter', sans-serif;
        }
        
        .form-group input:focus,
        .form-group textarea:focus {
            outline: none;
            border-color: #667eea;
            box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
        }
        
        .form-buttons {
            display: flex;
            gap: 12px;
            justify-content: flex-end;
            margin-top: 30px;
        }
        
        .progress-bar {
            width: 100%;
            height: 6px;
            background: #e5e7eb;
            border-radius: 3px;
            overflow: hidden;
            margin-top: 20px;
        }
        
        .progress-fill {
            height: 100%;
            background: linear-gradient(135deg, #667eea, #764ba2);
            width: 0%;
            transition: width 0.3s ease;
        }
        
        .tips {
            margin-top: 20px;
            padding: 16px;
            background: rgba(59, 130, 246, 0.1);
            border-radius: 12px;
            border-left: 4px solid #3b82f6;
        }
        
        .tips h4 {
            color: #1e40af;
            font-weight: 600;
            margin-bottom: 8px;
        }
        
        .tips p {
            color: #1e40af;
            font-size: 14px;
            line-height: 1.5;
        }
        
        .layer-control {
            display: flex;
            gap: 8px;
            margin-bottom: 15px;
        }
        
        .layer-btn {
            flex: 1;
            padding: 8px;
            border: 2px solid #e5e7eb;
            border-radius: 8px;
            background: white;
            font-size: 12px;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.2s ease;
        }
        
        .layer-btn.active {
            background: #667eea;
            color: white;
            border-color: #667eea;
        }
        
        @media (max-width: 1024px) {
            .main-content {
                grid-template-columns: 1fr;
                gap: 20px;
            }
            
            .canvas-section {
                order: -1;
            }
        }
        
        @media (max-width: 640px) {
            .container {
                padding: 20px;
                border-radius: 16px;
            }
            
            .header h1 {
                font-size: 2rem;
            }
            
            .preset-colors {
                grid-template-columns: repeat(4, 1fr);
            }
            
            .action-buttons {
                flex-direction: column;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>üé® ÌîΩÏÖÄÏïÑÌä∏ Ïä§ÌäúÎîîÏò§</h1>
            <p>ÎÇòÎßåÏùò Î©ãÏßÑ ÌîΩÏÖÄÏïÑÌä∏Î•º ÎßåÎì§Ïñ¥Î≥¥ÏÑ∏Ïöî!</p>
        </div>
        
        <div class="main-content">
            <!-- ÏôºÏ™Ω Ìå®ÎÑê - Ï∫îÎ≤ÑÏä§ ÏÑ§Ï†ï -->
            <div class="left-panel">
                <div class="section-title">‚öôÔ∏è Ï∫îÎ≤ÑÏä§ ÏÑ§Ï†ï</div>
                
                <div class="tool-group">
                    <label>Ï∫îÎ≤ÑÏä§ ÌÅ¨Í∏∞</label>
                    <div class="canvas-controls">
                        <select id="canvasSize">
                            <option value="8">8 √ó 8</option>
                            <option value="16" selected>16 √ó 16</option>
                            <option value="32">32 √ó 32</option>
                            <option value="64">64 √ó 64</option>
                            <option value="custom">ÏÇ¨Ïö©Ïûê Ï†ïÏùò</option>
                        </select>
                        <select id="pixelSize">
                            <option value="16">ÏûëÍ≤å</option>
                            <option value="24">Î≥¥ÌÜµ</option>
                            <option value="32" selected>ÌÅ¨Í≤å</option>
                            <option value="40">Îß§Ïö∞ ÌÅ¨Í≤å</option>
                        </select>
                    </div>
                    
                    <div id="customCanvas" class="custom-canvas" style="display: none;">
                        <input type="number" id="customWidth" placeholder="ÎÑàÎπÑ" min="4" max="128" value="16">
                        <input type="number" id="customHeight" placeholder="ÎÜíÏù¥" min="4" max="128" value="16">
                    </div>
                </div>
                
                <div class="tool-group">
                    <label>ÌòÑÏû¨ ÏÉâÏÉÅ</label>
                    <input type="color" id="colorPicker" class="color-picker" value="#000000">
                </div>
                
                <div class="tool-group">
                    <label>Í∑∏Î¶¨Í∏∞ ÎèÑÍµ¨</label>
                    <div class="drawing-tools">
                        <button class="tool-btn active" id="penTool">
                            ‚úèÔ∏è Ìéú
                        </button>
                        <button class="tool-btn" id="eraserTool">
                            üßπ ÏßÄÏö∞Í∞ú
                        </button>
                        <button class="tool-btn" id="bucketTool">
                            ü™£ Ï±ÑÏö∞Í∏∞
                        </button>
                    </div>
                </div>
                
                <div class="helper-tools">
                    <div class="section-title">üéØ ÎèÑÏõÄ ÎèÑÍµ¨</div>
                    <button class="helper-btn" id="gridToggle">üìê Í≤©Ïûê ÌëúÏãú/Ïà®ÍπÄ</button>
                    <button class="helper-btn" id="symmetryMode">üîÑ ÎåÄÏπ≠ Í∑∏Î¶¨Í∏∞</button>
                    <button class="helper-btn" id="undoBtn">‚Ü∂ Ïã§Ìñâ Ï∑®ÏÜå</button>
                    <button class="helper-btn" id="redoBtn">‚Ü∑ Îã§Ïãú Ïã§Ìñâ</button>
                </div>
            </div>
            
            <!-- Ï§ëÏïô - Ï∫îÎ≤ÑÏä§ -->
            <div class="canvas-section">
                <div class="canvas-info">
                    <span id="canvasInfo">16 √ó 16</span>
                    <span id="pixelCount">ÌîΩÏÖÄ: 0Í∞ú</span>
                    <span id="currentTool">ÎèÑÍµ¨: Ìéú</span>
                </div>
                
                <canvas id="pixelCanvas"></canvas>
                
                <div class="action-buttons">
                    <button class="btn btn-danger" id="clearCanvas">
                        üóëÔ∏è Ï†ÑÏ≤¥ ÏßÄÏö∞Í∏∞
                    </button>
                    <button class="btn btn-primary" id="downloadImage">
                        üíæ PNG Îã§Ïö¥Î°úÎìú
                    </button>
                    <button class="btn btn-secondary" id="mintNFT">
                        üé® NFT ÎßåÎì§Í∏∞
                    </button>
                </div>
            </div>
            
            <!-- Ïò§Î•∏Ï™Ω Ìå®ÎÑê - ÏÉâÏÉÅÍ≥º ÌÖúÌîåÎ¶ø -->
            <div class="right-panel">
                <div class="section-title">üé® ÏÉâÏÉÅ ÌåîÎ†àÌä∏</div>
                
                <div class="tool-group">
                    <div class="preset-colors" id="colorPalette">
                        <!-- Í∏∞Î≥∏ ÏÉâÏÉÅ -->
                        <div class="preset-color" style="background: #000000" data-color="#000000" title="Í≤ÄÏ†ï"></div>
                        <div class="preset-color" style="background: #ffffff" data-color="#ffffff" title="Ìù∞ÏÉâ"></div>
                        <div class="preset-color" style="background: #808080" data-color="#808080" title="ÌöåÏÉâ"></div>
                        <div class="preset-color" style="background: #c0c0c0" data-color="#c0c0c0" title="Ïó∞Ìïú ÌöåÏÉâ"></div>
                        <div class="preset-color" style="background: #ff0000" data-color="#ff0000" title="Îπ®Í∞ï"></div>
                        <div class="preset-color" style="background: #00ff00" data-color="#00ff00" title="Ï¥àÎ°ù"></div>
                        
                        <!-- ÌååÏä§ÌÖî ÌÜ§ -->
                        <div class="preset-color" style="background: #ffb3ba" data-color="#ffb3ba" title="ÌååÏä§ÌÖî ÌïëÌÅ¨"></div>
                        <div class="preset-color" style="background: #bae1ff" data-color="#bae1ff" title="ÌååÏä§ÌÖî Î∏îÎ£®"></div>
                        <div class="preset-color" style="background: #baffc9" data-color="#baffc9" title="ÌååÏä§ÌÖî Í∑∏Î¶∞"></div>
                        <div class="preset-color" style="background: #ffffba" data-color="#ffffba" title="ÌååÏä§ÌÖî ÏòêÎ°úÏö∞"></div>
                        <div class="preset-color" style="background: #ffdfba" data-color="#ffdfba" title="ÌååÏä§ÌÖî Ïò§Î†åÏßÄ"></div>
                        <div class="preset-color" style="background: #e0bbff" data-color="#e0bbff" title="ÌååÏä§ÌÖî ÌçºÌîå"></div>
                        
                        <!-- ÎπÑÎπÑÎìú Ïª¨Îü¨ -->
                        <div class="preset-color" style="background: #ff6b6b" data-color="#ff6b6b" title="ÏΩîÎûÑ"></div>
                        <div class="preset-color" style="background: #4ecdc4" data-color="#4ecdc4" title="ÌÑ∞ÏΩ∞Ïù¥Ï¶à"></div>
                        <div class="preset-color" style="background: #45b7d1" data-color="#45b7d1" title="Ïä§Ïπ¥Ïù¥ Î∏îÎ£®"></div>
                        <div class="preset-color" style="background: #96ceb4" data-color="#96ceb4" title="ÎØºÌä∏"></div>
                        <div class="preset-color" style="background: #feca57" data-color="#feca57" title="ÎßùÍ≥†"></div>
                        <div class="preset-color" style="background: #ff9ff3" data-color="#ff9ff3" title="ÌïëÌÅ¨"></div>
                        
                        <!-- Ïñ¥ÎëêÏö¥ ÌÜ§ -->
                        <div class="preset-color" style="background: #2c3e50" data-color="#2c3e50" title="Îã§ÌÅ¨ ÎÑ§Ïù¥ÎπÑ"></div>
                        <div class="preset-color" style="background: #8e44ad" data-color="#8e44ad" title="ÌçºÌîå"></div>
                        <div class="preset-color" style="background: #e74c3c" data-color="#e74c3c" title="Î†àÎìú"></div>
                        <div class="preset-color" style="background: #f39c12" data-color="#f39c12" title="Ïò§Î†åÏßÄ"></div>
                        <div class="preset-color" style="background: #27ae60" data-color="#27ae60" title="Í∑∏Î¶∞"></div>
                        <div class="preset-color" style="background: #3498db" data-color="#3498db" title="Î∏îÎ£®"></div>
                    </div>
                </div>
                
                <div class="tool-group">
                    <div class="section-title">üé≠ ÌÖúÌîåÎ¶ø</div>
                    <div class="templates">
                        <button class="template-btn" data-template="heart" title="ÌïòÌä∏">‚ù§Ô∏è</button>
                        <button class="template-btn" data-template="star" title="Î≥Ñ">‚≠ê</button>
                        <button class="template-btn" data-template="smiley" title="ÏõÉÎäî ÏñºÍµ¥">üòä</button>
                        <button class="template-btn" data-template="flower" title="ÍΩÉ">üå∏</button>
                        <button class="template-btn" data-template="cat" title="Í≥†ÏñëÏù¥">üê±</button>
                        <button class="template-btn" data-template="house" title="Ïßë">üè†</button>
                    </div>
                </div>
                
                <div class="tips">
                    <h4>üí° ÏÇ¨Ïö© ÌåÅ</h4>
                    <p id="currentTip">ÎßàÏö∞Ïä§Î•º ÌÅ¥Î¶≠ÌïòÍ±∞ÎÇò ÎìúÎûòÍ∑∏Ìï¥ÏÑú ÌîΩÏÖÄÏïÑÌä∏Î•º Í∑∏Î†§Î≥¥ÏÑ∏Ïöî!</p>
                </div>
                
                <div class="progress-bar">
                    <div class="progress-fill" id="progressFill"></div>
                </div>
            </div>
        </div>
        
        <!-- NFT Î©îÌÉÄÎç∞Ïù¥ÌÑ∞ Î™®Îã¨ -->
        <div id="nftModal" class="modal" style="display: none;">
            <div class="modal-content">
                <span class="close">&times;</span>
                <h2>üé® NFT Î©îÌÉÄÎç∞Ïù¥ÌÑ∞ ÏÉùÏÑ±</h2>
                <form id="nftForm">
                    <div class="form-group">
                        <label for="nftName">ÏûëÌíà Ï†úÎ™©:</label>
                        <input type="text" id="nftName" required placeholder="Ïòà: My Amazing Pixel Art">
                    </div>
                    <div class="form-group">
                        <label for="nftDescription">ÏÑ§Î™Ö:</label>
                        <textarea id="nftDescription" placeholder="ÏûëÌíàÏóê ÎåÄÌïú ÏÑ§Î™ÖÏùÑ ÏûÖÎ†•ÌïòÏÑ∏Ïöî" rows="3"></textarea>
                    </div>
                    <div class="form-group">
                        <label for="nftAttributes">ÏÜçÏÑ± (ÏÑ†ÌÉùÏÇ¨Ìï≠):</label>
                        <input type="text" id="nftAttributes" placeholder="Ïòà: Ïä§ÌÉÄÏùº:ÌîΩÏÖÄÏïÑÌä∏, ÏÉâÏÉÅ:Ïª¨Îü¨ÌíÄ">
                    </div>
                    <div class="form-buttons">
                        <button type="button" class="btn btn-secondary" id="cancelMint">Ï∑®ÏÜå</button>
                        <button type="submit" class="btn btn-primary" id="confirmMint">NFT ÏÉùÏÑ±</button>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <script>
        class PixelArtStudio {
            constructor() {
                this.canvas = document.getElementById('pixelCanvas');
                this.ctx = this.canvas.getContext('2d');
                this.gridSize = 16;
                this.pixelSize = 32;
                this.currentColor = '#000000';
                this.currentTool = 'pen';
                this.isDrawing = false;
                this.showGrid = true;
                this.symmetryMode = false;
                this.pixels = {};
                this.history = [];
                this.historyIndex = -1;
                this.maxHistory = 50;
                
                this.initCanvas();
                this.bindEvents();
                this.updateInfo();
                this.saveState();
                this.showRandomTip();
            }
            
            initCanvas() {
                const canvasPixelSize = this.gridSize * this.pixelSize;
                this.canvas.width = canvasPixelSize;
                this.canvas.height = canvasPixelSize;
                this.ctx.imageSmoothingEnabled = false;
                this.clearCanvas();
                this.drawGrid();
            }
            
            clearCanvas() {
                this.ctx.clearRect(0, 0, this.canvas.width, this.canvas.height);
                this.ctx.fillStyle = '#ffffff';
                this.ctx.fillRect(0, 0, this.canvas.width, this.canvas.height);
                this.pixels = {};
                this.drawGrid();
                this.updateInfo();
                this.updateProgress();
                console.log('Ï∫îÎ≤ÑÏä§Í∞Ä ÏôÑÏ†ÑÌûà ÏßÄÏõåÏ°åÏäµÎãàÎã§!');
            }
            
            drawGrid() {
                if (!this.showGrid) return;
                
                this.ctx.strokeStyle = 'rgba(0, 0, 0, 0.1)';
                this.ctx.lineWidth = 1;
                
                for (let x = 0; x <= this.canvas.width; x += this.pixelSize) {
                    this.ctx.beginPath();
                    this.ctx.moveTo(x, 0);
                    this.ctx.lineTo(x, this.canvas.height);
                    this.ctx.stroke();
                }
                
                for (let y = 0; y <= this.canvas.height; y += this.pixelSize) {
                    this.ctx.beginPath();
                    this.ctx.moveTo(0, y);
                    this.ctx.lineTo(this.canvas.width, y);
                    this.ctx.stroke();
                }
            }
            
            getPixelPosition(e) {
                const rect = this.canvas.getBoundingClientRect();
                const x = Math.floor((e.clientX - rect.left) / this.pixelSize);
                const y = Math.floor((e.clientY - rect.top) / this.pixelSize);
                return { x, y };
            }
            
            drawPixel(x, y, color) {
                if (x < 0 || x >= this.gridSize || y < 0 || y >= this.gridSize) return;
                
                const pixelX = x * this.pixelSize;
                const pixelY = y * this.pixelSize;
                
                this.ctx.fillStyle = color;
                this.ctx.fillRect(pixelX, pixelY, this.pixelSize, this.pixelSize);
                
                if (color === '#ffffff' || !color) {
                    delete this.pixels[`${x},${y}`];
                } else {
                    this.pixels[`${x},${y}`] = color;
                }
                
                // ÎåÄÏπ≠ Î™®Îìú
                if (this.symmetryMode) {
                    const symX = this.gridSize - 1 - x;
                    const symPixelX = symX * this.pixelSize;
                    
                    this.ctx.fillStyle = color;
                    this.ctx.fillRect(symPixelX, pixelY, this.pixelSize, this.pixelSize);
                    
                    if (color === '#ffffff' || !color) {
                        delete this.pixels[`${symX},${y}`];
                    } else {
                        this.pixels[`${symX},${y}`] = color;
                    }
                }
                
                if (this.showGrid) {
                    this.ctx.strokeStyle = 'rgba(0, 0, 0, 0.1)';
                    this.ctx.lineWidth = 1;
                    this.ctx.strokeRect(pixelX, pixelY, this.pixelSize, this.pixelSize);
                    
                    if (this.symmetryMode) {
                        const symPixelX = (this.gridSize - 1 - x) * this.pixelSize;
                        this.ctx.strokeRect(symPixelX, pixelY, this.pixelSize, this.pixelSize);
                    }
                }
            }
            
            erasePixel(x, y) {
                this.drawPixel(x, y, '#ffffff');
            }
            
            floodFill(x, y, newColor) {
                const key = `${x},${y}`;
                const originalColor = this.pixels[key] || '#ffffff';
                
                if (originalColor === newColor) return;
                
                const stack = [{x, y}];
                const visited = new Set();
                
                while (stack.length > 0) {
                    const {x: currentX, y: currentY} = stack.pop();
                    const currentKey = `${currentX},${currentY}`;
                    
                    if (visited.has(currentKey)) continue;
                    if (currentX < 0 || currentX >= this.gridSize || currentY < 0 || currentY >= this.gridSize) continue;
                    
                    const currentPixelColor = this.pixels[currentKey] || '#ffffff';
                    if (currentPixelColor !== originalColor) continue;
                    
                    visited.add(currentKey);
                    this.drawPixel(currentX, currentY, newColor);
                    
                    stack.push({x: currentX + 1, y: currentY});
                    stack.push({x: currentX - 1, y: currentY});
                    stack.push({x: currentX, y: currentY + 1});
                    stack.push({x: currentX, y: currentY - 1});
                }
            }
            
            handleCanvasClick(e) {
                const {x, y} = this.getPixelPosition(e);
                
                switch (this.currentTool) {
                    case 'pen':
                        this.drawPixel(x, y, this.currentColor);
                        break;
                    case 'eraser':
                        this.erasePixel(x, y);
                        break;
                    case 'bucket':
                        this.floodFill(x, y, this.currentColor);
                        break;
                }
                
                this.updateInfo();
                this.updateProgress();
            }
            
            redraw() {
                this.clearCanvas();
                
                for (const [key, color] of Object.entries(this.pixels)) {
                    const [x, y] = key.split(',').map(Number);
                    const pixelX = x * this.pixelSize;
                    const pixelY = y * this.pixelSize;
                    
                    this.ctx.fillStyle = color;
                    this.ctx.fillRect(pixelX, pixelY, this.pixelSize, this.pixelSize);
                }
                
                this.drawGrid();
            }
            
            saveState() {
                if (this.historyIndex < this.history.length - 1) {
                    this.history = this.history.slice(0, this.historyIndex + 1);
                }
                
                this.history.push(JSON.stringify(this.pixels));
                
                if (this.history.length > this.maxHistory) {
                    this.history.shift();
                } else {
                    this.historyIndex++;
                }
            }
            
            undo() {
                if (this.historyIndex > 0) {
                    this.historyIndex--;
                    this.pixels = JSON.parse(this.history[this.historyIndex]);
                    this.redraw();
                    this.updateInfo();
                }
            }
            
            redo() {
                if (this.historyIndex < this.history.length - 1) {
                    this.historyIndex++;
                    this.pixels = JSON.parse(this.history[this.historyIndex]);
                    this.redraw();
                    this.updateInfo();
                }
            }
            
            updateInfo() {
                document.getElementById('canvasInfo').textContent = `${this.gridSize} √ó ${this.gridSize}`;
                document.getElementById('pixelCount').textContent = `ÌîΩÏÖÄ: ${Object.keys(this.pixels).length}Í∞ú`;
                document.getElementById('currentTool').textContent = `ÎèÑÍµ¨: ${this.getToolName()}`;
            }
            
            getToolName() {
                const toolNames = { pen: 'Ìéú', eraser: 'ÏßÄÏö∞Í∞ú', bucket: 'Ï±ÑÏö∞Í∏∞' };
                return toolNames[this.currentTool] || 'Ìéú';
            }
            
            updateProgress() {
                const totalPixels = this.gridSize * this.gridSize;
                const filledPixels = Object.keys(this.pixels).length;
                const progress = (filledPixels / totalPixels) * 100;
                document.getElementById('progressFill').style.width = `${progress}%`;
            }
            
            showRandomTip() {
                const tips = [
                    "ÎßàÏö∞Ïä§Î•º ÌÅ¥Î¶≠ÌïòÍ±∞ÎÇò ÎìúÎûòÍ∑∏Ìï¥ÏÑú ÌîΩÏÖÄÏïÑÌä∏Î•º Í∑∏Î†§Î≥¥ÏÑ∏Ïöî!",
                    "Ï±ÑÏö∞Í∏∞ ÎèÑÍµ¨Î°ú ÎÑìÏùÄ ÏòÅÏó≠ÏùÑ Îπ†Î•¥Í≤å Ïπ†Ìï† Ïàò ÏûàÏñ¥Ïöî",
                    "ÎåÄÏπ≠ Í∑∏Î¶¨Í∏∞ Î™®ÎìúÎ°ú Ï¢åÏö∞ ÎåÄÏπ≠ ÏûëÌíàÏùÑ ÎßåÎì§Ïñ¥Î≥¥ÏÑ∏Ïöî",
                    "Ïã§Ìñâ Ï∑®ÏÜå(Ctrl+Z)Î°ú Ïã§ÏàòÎ•º ÎêòÎèåÎ¶¥ Ïàò ÏûàÏñ¥Ïöî",
                    "Í≤©ÏûêÎ•º Ïà®Í∏∞Î©¥ ÏôÑÏÑ±Îêú ÏûëÌíàÏùÑ ÎØ∏Î¶¨Î≥º Ïàò ÏûàÏñ¥Ïöî",
                    "ÌÖúÌîåÎ¶øÏùÑ ÏÇ¨Ïö©Ìï¥ÏÑú Îπ†Î•¥Í≤å ÏãúÏûëÌï¥Î≥¥ÏÑ∏Ïöî!",
                    "ÌååÏä§ÌÖî ÌÜ§ ÏÉâÏÉÅÏúºÎ°ú Î∂ÄÎìúÎü¨Ïö¥ ÎäêÎÇåÏùÑ Ïó∞Ï∂úÌï¥Î≥¥ÏÑ∏Ïöî",
                    "ÏûëÏùÄ Ï∫îÎ≤ÑÏä§ÏóêÏÑú ÏãúÏûëÌï¥ÏÑú Ï†êÏ†ê ÌÅ¨Í≤å ÎèÑÏ†ÑÌï¥Î≥¥ÏÑ∏Ïöî!"
                ];
                
                const randomTip = tips[Math.floor(Math.random() * tips.length)];
                document.getElementById('currentTip').textContent = randomTip;
            }
            
            downloadImage() {
                // ÏÇ¨Ïö©ÏûêÏóêÍ≤å Ìï¥ÏÉÅÎèÑ ÏÑ†ÌÉùÌïòÍ≤å ÌïòÍ∏∞
                const resolution = prompt('PNG Ìï¥ÏÉÅÎèÑÎ•º ÏÑ†ÌÉùÌïòÏÑ∏Ïöî:\n1 = 512√ó512\n2 = 1024√ó1024\n3 = ÏõêÎ≥∏ ÌÅ¨Í∏∞', '1');
                
                let outputSize;
                switch(resolution) {
                    case '1':
                        outputSize = 512;
                        break;
                    case '2':
                        outputSize = 1024;
                        break;
                    case '3':
                        outputSize = this.gridSize;
                        break;
                    default:
                        outputSize = 512;
                }
                
                // ÏõêÎ≥∏ ÌÅ¨Í∏∞Ïùò ÏûÑÏãú Ï∫îÎ≤ÑÏä§ ÏÉùÏÑ±
                const tempCanvas = document.createElement('canvas');
                const tempCtx = tempCanvas.getContext('2d');
                tempCanvas.width = this.gridSize;
                tempCanvas.height = this.gridSize;
                
                // ÌîΩÏÖÄ ÏïÑÌä∏ Í∑∏Î¶¨Í∏∞
                tempCtx.fillStyle = '#ffffff';
                tempCtx.fillRect(0, 0, tempCanvas.width, tempCanvas.height);
                
                for (const [key, color] of Object.entries(this.pixels)) {
                    const [x, y] = key.split(',').map(Number);
                    tempCtx.fillStyle = color;
                    tempCtx.fillRect(x, y, 1, 1);
                }
                
                // ÏµúÏ¢Ö Ï∂úÎ†•Ïö© Ï∫îÎ≤ÑÏä§ ÏÉùÏÑ± (nearest neighbor Ïä§ÏºÄÏùºÎßÅ)
                const outputCanvas = document.createElement('canvas');
                const outputCtx = outputCanvas.getContext('2d');
                outputCanvas.width = outputSize;
                outputCanvas.height = outputSize;
                
                // nearest neighbor Ìö®Í≥ºÎ•º ÏúÑÌï¥ imageSmoothingEnabled ÎπÑÌôúÏÑ±Ìôî
                outputCtx.imageSmoothingEnabled = false;
                outputCtx.mozImageSmoothingEnabled = false;
                outputCtx.webkitImageSmoothingEnabled = false;
                outputCtx.msImageSmoothingEnabled = false;
                
                // ÏõêÎ≥∏ Ïù¥ÎØ∏ÏßÄÎ•º Ï∂úÎ†• ÌÅ¨Í∏∞Î°ú Ïä§ÏºÄÏùºÎßÅ
                outputCtx.drawImage(tempCanvas, 0, 0, outputSize, outputSize);
                
                const link = document.createElement('a');
                link.download = `pixel-art-${outputSize}x${outputSize}.png`;
                link.href = outputCanvas.toDataURL('image/png');
                link.click();
                
                console.log(`PNG Îã§Ïö¥Î°úÎìú ÏôÑÎ£å: ${outputSize}√ó${outputSize}`);
            }
            
            openMintModal() {
                if (Object.keys(this.pixels).length === 0) {
                    alert('Î®ºÏ†Ä ÌîΩÏÖÄÏïÑÌä∏Î•º Í∑∏Î†§Ï£ºÏÑ∏Ïöî! üé®');
                    return;
                }
                document.getElementById('nftModal').style.display = 'block';
            }
            
            closeMintModal() {
                document.getElementById('nftModal').style.display = 'none';
                document.getElementById('nftForm').reset();
            }
            
            async handleMintSubmit(e) {
                e.preventDefault();
                
                const name = document.getElementById('nftName').value;
                const description = document.getElementById('nftDescription').value;
                const attributes = document.getElementById('nftAttributes').value;
                
                await this.createNFTMetadata(name, description, attributes);
            }
            
            async createNFTMetadata(name, description, attributes) {
                try {
                    // Î°úÎî© ÏÉÅÌÉú
                    document.getElementById('confirmMint').disabled = true;
                    document.getElementById('confirmMint').textContent = 'NFT ÏÉùÏÑ± Ï§ë...';
                    
                    // Í≥†Ìï¥ÏÉÅÎèÑ Ïù¥ÎØ∏ÏßÄ ÏÉùÏÑ± (1024x1024)
                    const imageData = this.getHighResImage();
                    
                    // NFT Î©îÌÉÄÎç∞Ïù¥ÌÑ∞ ÏÉùÏÑ±
                    const metadata = {
                        name: name,
                        description: description,
                        image: imageData,
                        attributes: this.parseAttributes(attributes),
                        external_url: "https://gimt4319y.github.io/pixel_art/",
                        background_color: "FFFFFF",
                        animation_url: null,
                        properties: {
                            created_by: "Pixel Art Studio",
                            created_at: new Date().toISOString(),
                            canvas_size: `${this.gridSize}x${this.gridSize}`,
                            pixel_count: Object.keys(this.pixels).length,
                            total_colors: new Set(Object.values(this.pixels)).size,
                            creation_method: "Hand-drawn"
                        }
                    };
                    
                    // Î©îÌÉÄÎç∞Ïù¥ÌÑ∞Î•º JSON ÌååÏùºÎ°ú Îã§Ïö¥Î°úÎìú
                    const dataStr = JSON.stringify(metadata, null, 2);
                    const dataUri = 'data:application/json;charset=utf-8,'+ encodeURIComponent(dataStr);
                    
                    const exportFileDefaultName = `${name.replace(/[^a-z0-9]/gi, '_').toLowerCase()}_nft_metadata.json`;
                    
                    const linkElement = document.createElement('a');
                    linkElement.setAttribute('href', dataUri);
                    linkElement.setAttribute('download', exportFileDefaultName);
                    linkElement.click();
                    
                    // ÏÑ±Í≥µ Î©îÏãúÏßÄ
                    alert(`üéâ NFT Î©îÌÉÄÎç∞Ïù¥ÌÑ∞Í∞Ä ÏÉùÏÑ±ÎêòÏóàÏäµÎãàÎã§!\n\nüìÑ ÌååÏùº: ${exportFileDefaultName}\nüé® ÏûëÌíà: ${name}\nüìù ÏÑ§Î™Ö: ${description || 'ÏóÜÏùå'}\nüéØ ÌîΩÏÖÄ Ïàò: ${Object.keys(this.pixels).length}Í∞ú\nüåà ÏÇ¨Ïö©Îêú ÏÉâÏÉÅ: ${new Set(Object.values(this.pixels)).size}Í∞ÄÏßÄ`);
                    
                    this.closeMintModal();
                    
                } catch (error) {
                    console.error('NFT Î©îÌÉÄÎç∞Ïù¥ÌÑ∞ ÏÉùÏÑ± Ïã§Ìå®:', error);
                    alert('NFT ÏÉùÏÑ±Ïóê Ïã§Ìå®ÌñàÏäµÎãàÎã§: ' + error.message);
                } finally {
                    document.getElementById('confirmMint').disabled = false;
                    document.getElementById('confirmMint').textContent = 'NFT ÏÉùÏÑ±';
                }
            }
            
            getHighResImage() {
                // 1024x1024 Í≥†Ìï¥ÏÉÅÎèÑ Ïù¥ÎØ∏ÏßÄ ÏÉùÏÑ±
                const tempCanvas = document.createElement('canvas');
                const tempCtx = tempCanvas.getContext('2d');
                tempCanvas.width = this.gridSize;
                tempCanvas.height = this.gridSize;
                
                // ÌîΩÏÖÄÏïÑÌä∏ Í∑∏Î¶¨Í∏∞
                tempCtx.fillStyle = '#ffffff';
                tempCtx.fillRect(0, 0, tempCanvas.width, tempCanvas.height);
                
                for (const [key, color] of Object.entries(this.pixels)) {
                    const [x, y] = key.split(',').map(Number);
                    tempCtx.fillStyle = color;
                    tempCtx.fillRect(x, y, 1, 1);
                }
                
                // 1024x1024Î°ú Ïä§ÏºÄÏùºÏóÖ
                const outputCanvas = document.createElement('canvas');
                const outputCtx = outputCanvas.getContext('2d');
                outputCanvas.width = 1024;
                outputCanvas.height = 1024;
                
                outputCtx.imageSmoothingEnabled = false;
                outputCtx.mozImageSmoothingEnabled = false;
                outputCtx.webkitImageSmoothingEnabled = false;
                outputCtx.msImageSmoothingEnabled = false;
                
                outputCtx.drawImage(tempCanvas, 0, 0, 1024, 1024);
                
                return outputCanvas.toDataURL('image/png');
            }
            
            parseAttributes(attributesString) {
                if (!attributesString) {
                    return [
                        {
                            "trait_type": "Style",
                            "value": "Pixel Art"
                        },
                        {
                            "trait_type": "Canvas Size",
                            "value": `${this.gridSize}x${this.gridSize}`
                        },
                        {
                            "trait_type": "Pixel Count",
                            "value": Object.keys(this.pixels).length
                        }
                    ];
                }
                
                const customAttributes = attributesString.split(',').map(attr => {
                    const [key, value] = attr.split(':').map(s => s.trim());
                    return { trait_type: key, value: value };
                }).filter(attr => attr.trait_type && attr.value);
                
                // Í∏∞Î≥∏ ÏÜçÏÑ± Ï∂îÍ∞Ä
                const defaultAttributes = [
                    {
                        "trait_type": "Style",
                        "value": "Pixel Art"
                    },
                    {
                        "trait_type": "Canvas Size", 
                        "value": `${this.gridSize}x${this.gridSize}`
                    },
                    {
                        "trait_type": "Pixel Count",
                        "value": Object.keys(this.pixels).length
                    }
                ];
                
                return [...defaultAttributes, ...customAttributes];
            }Ìä∏ ÌååÏùºÏùÑ ÏùΩÏùÑ Ïàò ÏóÜÏäµÎãàÎã§.');
                            }
                        };
                        reader.readAsText(file);
                    }
                };
                input.click();
            }
            
            loadTemplate(templateName) {
                const templates = {
                    heart: {
                        16: {
                            "5,3": "#ff6b6b", "6,3": "#ff6b6b", "8,3": "#ff6b6b", "9,3": "#ff6b6b",
                            "4,4": "#ff6b6b", "5,4": "#ff6b6b", "6,4": "#ff6b6b", "7,4": "#ff6b6b", "8,4": "#ff6b6b", "9,4": "#ff6b6b", "10,4": "#ff6b6b",
                            "4,5": "#ff6b6b", "5,5": "#ff6b6b", "6,5": "#ff6b6b", "7,5": "#ff6b6b", "8,5": "#ff6b6b", "9,5": "#ff6b6b", "10,5": "#ff6b6b",
                            "5,6": "#ff6b6b", "6,6": "#ff6b6b", "7,6": "#ff6b6b", "8,6": "#ff6b6b", "9,6": "#ff6b6b",
                            "6,7": "#ff6b6b", "7,7": "#ff6b6b", "8,7": "#ff6b6b",
                            "7,8": "#ff6b6b"
                        }
                    },
                    star: {
                        16: {
                            "7,2": "#feca57", "8,2": "#feca57",
                            "6,3": "#feca57", "7,3": "#feca57", "8,3": "#feca57", "9,3": "#feca57",
                            "5,4": "#feca57", "6,4": "#feca57", "7,4": "#feca57", "8,4": "#feca57", "9,4": "#feca57", "10,4": "#feca57",
                            "6,5": "#feca57", "7,5": "#feca57", "8,5": "#feca57", "9,5": "#feca57",
                            "7,6": "#feca57", "8,6": "#feca57"
                        }
                    },
                    smiley: {
                        16: {
                            "5,4": "#000000", "6,4": "#000000", "9,4": "#000000", "10,4": "#000000",
                            "4,8": "#000000", "5,9": "#000000", "6,10": "#000000", "7,10": "#000000", "8,10": "#000000", "9,10": "#000000", "10,9": "#000000", "11,8": "#000000"
                        }
                    }
                };
                
                const template = templates[templateName];
                if (template && template[this.gridSize]) {
                    this.pixels = { ...this.pixels, ...template[this.gridSize] };
                    this.redraw();
                    this.updateInfo();
                    this.saveState();
                }
            }
            
            setTool(tool) {
                this.currentTool = tool;
                
                document.querySelectorAll('.tool-btn').forEach(btn => btn.classList.remove('active'));
                document.getElementById(tool + 'Tool').classList.add('active');
                
                if (tool === 'bucket') {
                    this.canvas.style.cursor = 'pointer';
                } else {
                    this.canvas.style.cursor = 'crosshair';
                }
                
                this.updateInfo();
            }
            
            setCanvasSize(size) {
                if (size === 'custom') {
                    document.getElementById('customCanvas').style.display = 'grid';
                    return;
                } else {
                    document.getElementById('customCanvas').style.display = 'none';
                }
                
                this.gridSize = parseInt(size);
                this.initCanvas();
                this.updateInfo();
                this.saveState();
            }
            
            setCustomCanvasSize() {
                const width = parseInt(document.getElementById('customWidth').value) || 16;
                const height = parseInt(document.getElementById('customHeight').value) || 16;
                
                this.gridSize = Math.min(Math.max(width, 4), 128);
                this.initCanvas();
                this.updateInfo();
                this.saveState();
            }
            
            bindEvents() {
                // Ï∫îÎ≤ÑÏä§ Ïù¥Î≤§Ìä∏
                this.canvas.addEventListener('click', (e) => {
                    this.handleCanvasClick(e);
                    this.saveState();
                });
                
                this.canvas.addEventListener('mousedown', (e) => {
                    this.isDrawing = true;
                    this.handleCanvasClick(e);
                });
                
                this.canvas.addEventListener('mousemove', (e) => {
                    if (this.isDrawing && (this.currentTool === 'pen' || this.currentTool === 'eraser')) {
                        this.handleCanvasClick(e);
                    }
                });
                
                this.canvas.addEventListener('mouseup', () => {
                    if (this.isDrawing) {
                        this.saveState();
                    }
                    this.isDrawing = false;
                });
                
                this.canvas.addEventListener('mouseleave', () => {
                    if (this.isDrawing) {
                        this.saveState();
                    }
                    this.isDrawing = false;
                });
                
                // ÎèÑÍµ¨ Ïù¥Î≤§Ìä∏
                document.getElementById('penTool').addEventListener('click', () => this.setTool('pen'));
                document.getElementById('eraserTool').addEventListener('click', () => this.setTool('eraser'));
                document.getElementById('bucketTool').addEventListener('click', () => this.setTool('bucket'));
                
                // ÏÉâÏÉÅ Ïù¥Î≤§Ìä∏
                document.getElementById('colorPicker').addEventListener('change', (e) => {
                    this.currentColor = e.target.value;
                    document.querySelectorAll('.preset-color').forEach(el => el.classList.remove('selected'));
                });
                
                // ÌîÑÎ¶¨ÏÖã ÏÉâÏÉÅ Ïù¥Î≤§Ìä∏
                document.querySelectorAll('.preset-color').forEach(colorDiv => {
                    colorDiv.addEventListener('click', () => {
                        this.currentColor = colorDiv.dataset.color;
                        document.getElementById('colorPicker').value = this.currentColor;
                        
                        document.querySelectorAll('.preset-color').forEach(el => el.classList.remove('selected'));
                        colorDiv.classList.add('selected');
                    });
                });
                
                // Ï∫îÎ≤ÑÏä§ ÌÅ¨Í∏∞ Î≥ÄÍ≤Ω
                document.getElementById('canvasSize').addEventListener('change', (e) => {
                    this.setCanvasSize(e.target.value);
                });
                
                document.getElementById('customWidth').addEventListener('change', () => this.setCustomCanvasSize());
                document.getElementById('customHeight').addEventListener('change', () => this.setCustomCanvasSize());
                
                // ÌîΩÏÖÄ ÌÅ¨Í∏∞ Î≥ÄÍ≤Ω
                document.getElementById('pixelSize').addEventListener('change', (e) => {
                    this.pixelSize = parseInt(e.target.value);
                    this.initCanvas();
                    this.redraw();
                });
                
                // Ïª®Ìä∏Î°§ Î≤ÑÌäºÎì§
                document.getElementById('clearCanvas').addEventListener('click', () => {
                    if (confirm('‚ö†Ô∏è Ï†ïÎßê Î™®Îì† ÎÇ¥Ïö©ÏùÑ ÏßÄÏö∞ÏãúÍ≤†ÏäµÎãàÍπå?\n\nÏù¥ ÏûëÏóÖÏùÄ ÎêòÎèåÎ¶¥ Ïàò ÏóÜÏäµÎãàÎã§.')) {
                        this.clearCanvas();
                        this.saveState();
                        console.log('Ï∫îÎ≤ÑÏä§ ÏßÄÏö∞Í∏∞ ÏôÑÎ£å');
                    }
                });
                
                document.getElementById('downloadImage').addEventListener('click', () => this.downloadImage());
                
                // NFT Í¥ÄÎ†® Ïù¥Î≤§Ìä∏
                document.getElementById('mintNFT').addEventListener('click', () => this.openMintModal());
                document.getElementById('cancelMint').addEventListener('click', () => this.closeMintModal());
                document.getElementById('nftForm').addEventListener('submit', (e) => this.handleMintSubmit(e));
                document.querySelector('.close').addEventListener('click', () => this.closeMintModal());
                
                document.getElementById('gridToggle').addEventListener('click', () => {
                    this.showGrid = !this.showGrid;
                    this.redraw();
                    document.getElementById('gridToggle').textContent = this.showGrid ? 'üìê Í≤©Ïûê Ïà®ÍπÄ' : 'üìê Í≤©Ïûê ÌëúÏãú';
                });
                
                document.getElementById('symmetryMode').addEventListener('click', () => {
                    this.symmetryMode = !this.symmetryMode;
                    document.getElementById('symmetryMode').textContent = this.symmetryMode ? 'üîÑ ÎåÄÏπ≠ Ìï¥Ï†ú' : 'üîÑ ÎåÄÏπ≠ Í∑∏Î¶¨Í∏∞';
                    document.getElementById('symmetryMode').style.background = this.symmetryMode ? 'rgba(102, 126, 234, 0.2)' : '';
                });
                
                document.getElementById('undoBtn').addEventListener('click', () => this.undo());
                document.getElementById('redoBtn').addEventListener('click', () => this.redo());
                
                // Î™®Îã¨ Ïô∏Î∂Ä ÌÅ¥Î¶≠ Ïãú Îã´Í∏∞
                document.getElementById('nftModal').addEventListener('click', (e) => {
                    if (e.target === document.getElementById('nftModal')) {
                        this.closeMintModal();
                    }
                });
                
                // ÌÇ§Î≥¥Îìú Îã®Ï∂ïÌÇ§
                document.addEventListener('keydown', (e) => {
                    if (e.ctrlKey || e.metaKey) {
                        switch (e.key) {
                            case 'z':
                                e.preventDefault();
                                if (e.shiftKey) {
                                    this.redo();
                                } else {
                                    this.undo();
                                }
                                break;
                            case 'y':
                                e.preventDefault();
                                this.redo();
                                break;
                            case 's':
                                e.preventDefault();
                                this.saveProject();
                                break;
                        }
                    }
                    
                    // ÎèÑÍµ¨ Îã®Ï∂ïÌÇ§
                    switch (e.key) {
                        case '1':
                        case 'p':
                            this.setTool('pen');
                            break;
                        case '2':
                        case 'e':
                            this.setTool('eraser');
                            break;
                        case '3':
                        case 'b':
                            this.setTool('bucket');
                            break;
                        case 'g':
                            document.getElementById('gridToggle').click();
                            break;
                    }
                });
                
                // ÌåÅ Î°úÌÖåÏù¥ÏÖò
                setInterval(() => {
                    this.showRandomTip();
                }, 10000);
            }
        }
        
        // ÌéòÏù¥ÏßÄ Î°úÎìú Ïãú Ïä§ÌäúÎîîÏò§ Ï¥àÍ∏∞Ìôî
        window.addEventListener('load', () => {
            new PixelArtStudio();
        });
    </script>
</body>
</html>
